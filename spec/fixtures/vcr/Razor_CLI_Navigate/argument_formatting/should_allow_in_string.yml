---
http_interactions:
- request:
    method: get
    uri: https://localhost:8151/api
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Server:
      - Apache-Coyote/1.1
      X-Content-Type-Options:
      - nosniff
      Content-Type:
      - application/json;charset=utf-8
      Content-Length:
      - '4981'
      Date:
      - Thu, 14 Aug 2014 21:10:25 GMT
    body:
      encoding: US-ASCII
      string: '{"commands":[{"name":"add-policy-tag","rel":"https://api.puppetlabs.com/razor/v1/commands/add-policy-tag","id":"https://localhost:8151/api/commands/add-policy-tag"},{"name":"create-broker","rel":"https://api.puppetlabs.com/razor/v1/commands/create-broker","id":"https://localhost:8151/api/commands/create-broker"},{"name":"create-policy","rel":"https://api.puppetlabs.com/razor/v1/commands/create-policy","id":"https://localhost:8151/api/commands/create-policy"},{"name":"create-repo","rel":"https://api.puppetlabs.com/razor/v1/commands/create-repo","id":"https://localhost:8151/api/commands/create-repo"},{"name":"create-tag","rel":"https://api.puppetlabs.com/razor/v1/commands/create-tag","id":"https://localhost:8151/api/commands/create-tag"},{"name":"create-task","rel":"https://api.puppetlabs.com/razor/v1/commands/create-task","id":"https://localhost:8151/api/commands/create-task"},{"name":"delete-broker","rel":"https://api.puppetlabs.com/razor/v1/commands/delete-broker","id":"https://localhost:8151/api/commands/delete-broker"},{"name":"delete-node","rel":"https://api.puppetlabs.com/razor/v1/commands/delete-node","id":"https://localhost:8151/api/commands/delete-node"},{"name":"delete-policy","rel":"https://api.puppetlabs.com/razor/v1/commands/delete-policy","id":"https://localhost:8151/api/commands/delete-policy"},{"name":"delete-repo","rel":"https://api.puppetlabs.com/razor/v1/commands/delete-repo","id":"https://localhost:8151/api/commands/delete-repo"},{"name":"delete-tag","rel":"https://api.puppetlabs.com/razor/v1/commands/delete-tag","id":"https://localhost:8151/api/commands/delete-tag"},{"name":"disable-policy","rel":"https://api.puppetlabs.com/razor/v1/commands/disable-policy","id":"https://localhost:8151/api/commands/disable-policy"},{"name":"enable-policy","rel":"https://api.puppetlabs.com/razor/v1/commands/enable-policy","id":"https://localhost:8151/api/commands/enable-policy"},{"name":"modify-node-metadata","rel":"https://api.puppetlabs.com/razor/v1/commands/modify-node-metadata","id":"https://localhost:8151/api/commands/modify-node-metadata"},{"name":"modify-policy-max-count","rel":"https://api.puppetlabs.com/razor/v1/commands/modify-policy-max-count","id":"https://localhost:8151/api/commands/modify-policy-max-count"},{"name":"move-policy","rel":"https://api.puppetlabs.com/razor/v1/commands/move-policy","id":"https://localhost:8151/api/commands/move-policy"},{"name":"reboot-node","rel":"https://api.puppetlabs.com/razor/v1/commands/reboot-node","id":"https://localhost:8151/api/commands/reboot-node"},{"name":"register-node","rel":"https://api.puppetlabs.com/razor/v1/commands/register-node","id":"https://localhost:8151/api/commands/register-node"},{"name":"reinstall-node","rel":"https://api.puppetlabs.com/razor/v1/commands/reinstall-node","id":"https://localhost:8151/api/commands/reinstall-node"},{"name":"remove-node-metadata","rel":"https://api.puppetlabs.com/razor/v1/commands/remove-node-metadata","id":"https://localhost:8151/api/commands/remove-node-metadata"},{"name":"remove-policy-tag","rel":"https://api.puppetlabs.com/razor/v1/commands/remove-policy-tag","id":"https://localhost:8151/api/commands/remove-policy-tag"},{"name":"set-node-desired-power-state","rel":"https://api.puppetlabs.com/razor/v1/commands/set-node-desired-power-state","id":"https://localhost:8151/api/commands/set-node-desired-power-state"},{"name":"set-node-hw-info","rel":"https://api.puppetlabs.com/razor/v1/commands/set-node-hw-info","id":"https://localhost:8151/api/commands/set-node-hw-info"},{"name":"set-node-ipmi-credentials","rel":"https://api.puppetlabs.com/razor/v1/commands/set-node-ipmi-credentials","id":"https://localhost:8151/api/commands/set-node-ipmi-credentials"},{"name":"update-node-metadata","rel":"https://api.puppetlabs.com/razor/v1/commands/update-node-metadata","id":"https://localhost:8151/api/commands/update-node-metadata"},{"name":"update-tag-rule","rel":"https://api.puppetlabs.com/razor/v1/commands/update-tag-rule","id":"https://localhost:8151/api/commands/update-tag-rule"}],"collections":[{"name":"brokers","rel":"https://api.puppetlabs.com/razor/v1/collections/brokers","id":"https://localhost:8151/api/collections/brokers"},{"name":"repos","rel":"https://api.puppetlabs.com/razor/v1/collections/repos","id":"https://localhost:8151/api/collections/repos"},{"name":"tags","rel":"https://api.puppetlabs.com/razor/v1/collections/tags","id":"https://localhost:8151/api/collections/tags"},{"name":"policies","rel":"https://api.puppetlabs.com/razor/v1/collections/policies","id":"https://localhost:8151/api/collections/policies"},{"name":"nodes","rel":"https://api.puppetlabs.com/razor/v1/collections/nodes","id":"https://localhost:8151/api/collections/nodes"},{"name":"tasks","rel":"https://api.puppetlabs.com/razor/v1/collections/tasks","id":"https://localhost:8151/api/collections/tasks"},{"name":"commands","rel":"https://api.puppetlabs.com/razor/v1/collections/commands","id":"https://localhost:8151/api/collections/commands"}],"version":{"server":"v0.15.0-26-gfffaba4-dirty"}}'
    http_version:
  recorded_at: Thu, 14 Aug 2014 21:10:25 GMT
- request:
    method: get
    uri: https://localhost:8151/api/commands/create-repo
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Server:
      - Apache-Coyote/1.1
      Etag:
      - '"server-version-v0.15.0-26-gfffaba4-dirty"'
      X-Content-Type-Options:
      - nosniff
      Content-Type:
      - application/json;charset=utf-8
      Content-Length:
      - '3240'
      Date:
      - Thu, 14 Aug 2014 21:10:25 GMT
    body:
      encoding: US-ASCII
      string: '{"name":"create-repo","help":{"full":"# SYNOPSIS\nCreate a new repository,
        from an ISO image or a URL\n\n# DESCRIPTION\nCreate a new repository, which
        can either contain the content to install a\nnode, or simply point to an existing
        online repository by URL.\n\n# Access Control\n\nThis command''s access control
        pattern: `commands:create-repo:%{name}`\n\nWords surrounded by `%{...}` are
        substitutions from the input data: typically\nthe name of the object being
        modified, or some other critical detail, these\nallow roles to be granted
        partial access to modify the system.\n\nFor more detail on how the permission
        strings are structured and work, you can\nsee the [Shiro Permissions documentation][shiro].  That
        pattern is expanded\nand then a permission check applied to it, before the
        command is authorized.\n\nThese checks only apply if security is enabled in
        the Razor configuration\nfile; on this server security is currently disabled.\n\n[shiro]:
        https://shiro.apache.org/permissions.html\n\n# Attributes\n\n * name\n   -
        The name of the repository.\n   - This attribute is required.\n   - It must
        be of type string.\n   - It must be between 1 and 250 in length.\n\n * url\n   -
        The URL of the remote repository to use.\n   - It must be of type string.\n   -
        If present, iso-url must not be present.\n   - It must be between 1 and 1000
        in length.\n\n * iso-url\n   - The URL of the ISO image to download and unpack
        to create the\n     repository.  This can be an https or httpsS URL, or it can
        be a\n     file URL.\n     \n     In the latter case, the file path is interpreted
        as a path on the\n     Razor server, rather than a path on the client.  This
        requires that\n     you manually place the ISO image on the server before
        invoking the\n     command.\n   - It must be of type string.\n   - If present,
        url must not be present.\n   - It must be between 1 and 1000 in length.\n\n
        * task\n   - The name of the task associated with this repository.  This is
        used to\n     install nodes that match a policy using this repository; generally
        it\n     should match the OS that the URL or ISO-URL attributes point to.\n   -
        This attribute is required.\n   - It must be of type string.\n\n# EXAMPLES\n\n  Create
        a repository from an ISO image, which will be downloaded and unpacked\n  by
        the razor-server in the background:\n  \n      {\n        \"name\":    \"fedora19\",\n        \"iso-url\":
        \"https://example.com/Fedora-19-x86_64-DVD.iso\"\n        \"task\":    \"fedora\"\n      }\n  \n  You
        can also unpack an ISO image from a file *on the server*; this does not\n  upload
        the file from the client:\n      {\n        \"name\":    \"fedora19\",\n        \"iso-url\":
        \"file:///tmp/Fedora-19-x86_64-DVD.iso\"\n        \"task\":    \"fedora\"\n      }\n  \n  Finally,
        you can provide a `url` property when you create the repository;\n  this form
        is merely a pointer to a resource somewhere and nothing will be\n  downloaded
        onto the Razor server:\n  \n      {\n        \"name\": \"fedora19\",\n        \"url\":  \"https://mirrors.n-ix.net/fedora/linux/releases/19/Fedora/x86_64/os/\"\n        \"task\":
        \"fedora\"\n      }\n"},"schema":{"name":{"type":"string"},"url":{"type":"string"},"iso-url":{"type":"string"},"task":{"type":"string"}}}'
    http_version:
  recorded_at: Thu, 14 Aug 2014 21:10:25 GMT
- request:
    method: get
    uri: https://localhost:8151/api/commands/create-repo
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Server:
      - Apache-Coyote/1.1
      Etag:
      - '"server-version-v0.15.0-26-gfffaba4-dirty"'
      X-Content-Type-Options:
      - nosniff
      Content-Type:
      - application/json;charset=utf-8
      Content-Length:
      - '3240'
      Date:
      - Thu, 14 Aug 2014 21:10:25 GMT
    body:
      encoding: US-ASCII
      string: '{"name":"create-repo","help":{"full":"# SYNOPSIS\nCreate a new repository,
        from an ISO image or a URL\n\n# DESCRIPTION\nCreate a new repository, which
        can either contain the content to install a\nnode, or simply point to an existing
        online repository by URL.\n\n# Access Control\n\nThis command''s access control
        pattern: `commands:create-repo:%{name}`\n\nWords surrounded by `%{...}` are
        substitutions from the input data: typically\nthe name of the object being
        modified, or some other critical detail, these\nallow roles to be granted
        partial access to modify the system.\n\nFor more detail on how the permission
        strings are structured and work, you can\nsee the [Shiro Permissions documentation][shiro].  That
        pattern is expanded\nand then a permission check applied to it, before the
        command is authorized.\n\nThese checks only apply if security is enabled in
        the Razor configuration\nfile; on this server security is currently disabled.\n\n[shiro]:
        https://shiro.apache.org/permissions.html\n\n# Attributes\n\n * name\n   -
        The name of the repository.\n   - This attribute is required.\n   - It must
        be of type string.\n   - It must be between 1 and 250 in length.\n\n * url\n   -
        The URL of the remote repository to use.\n   - It must be of type string.\n   -
        If present, iso-url must not be present.\n   - It must be between 1 and 1000
        in length.\n\n * iso-url\n   - The URL of the ISO image to download and unpack
        to create the\n     repository.  This can be an https or httpsS URL, or it can
        be a\n     file URL.\n     \n     In the latter case, the file path is interpreted
        as a path on the\n     Razor server, rather than a path on the client.  This
        requires that\n     you manually place the ISO image on the server before
        invoking the\n     command.\n   - It must be of type string.\n   - If present,
        url must not be present.\n   - It must be between 1 and 1000 in length.\n\n
        * task\n   - The name of the task associated with this repository.  This is
        used to\n     install nodes that match a policy using this repository; generally
        it\n     should match the OS that the URL or ISO-URL attributes point to.\n   -
        This attribute is required.\n   - It must be of type string.\n\n# EXAMPLES\n\n  Create
        a repository from an ISO image, which will be downloaded and unpacked\n  by
        the razor-server in the background:\n  \n      {\n        \"name\":    \"fedora19\",\n        \"iso-url\":
        \"https://example.com/Fedora-19-x86_64-DVD.iso\"\n        \"task\":    \"fedora\"\n      }\n  \n  You
        can also unpack an ISO image from a file *on the server*; this does not\n  upload
        the file from the client:\n      {\n        \"name\":    \"fedora19\",\n        \"iso-url\":
        \"file:///tmp/Fedora-19-x86_64-DVD.iso\"\n        \"task\":    \"fedora\"\n      }\n  \n  Finally,
        you can provide a `url` property when you create the repository;\n  this form
        is merely a pointer to a resource somewhere and nothing will be\n  downloaded
        onto the Razor server:\n  \n      {\n        \"name\": \"fedora19\",\n        \"url\":  \"https://mirrors.n-ix.net/fedora/linux/releases/19/Fedora/x86_64/os/\"\n        \"task\":
        \"fedora\"\n      }\n"},"schema":{"name":{"type":"string"},"url":{"type":"string"},"iso-url":{"type":"string"},"task":{"type":"string"}}}'
    http_version:
  recorded_at: Thu, 14 Aug 2014 21:10:25 GMT
- request:
    method: get
    uri: https://localhost:8151/api/commands/create-repo
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Server:
      - Apache-Coyote/1.1
      Etag:
      - '"server-version-v0.15.0-26-gfffaba4-dirty"'
      X-Content-Type-Options:
      - nosniff
      Content-Type:
      - application/json;charset=utf-8
      Content-Length:
      - '3240'
      Date:
      - Thu, 14 Aug 2014 21:10:25 GMT
    body:
      encoding: US-ASCII
      string: '{"name":"create-repo","help":{"full":"# SYNOPSIS\nCreate a new repository,
        from an ISO image or a URL\n\n# DESCRIPTION\nCreate a new repository, which
        can either contain the content to install a\nnode, or simply point to an existing
        online repository by URL.\n\n# Access Control\n\nThis command''s access control
        pattern: `commands:create-repo:%{name}`\n\nWords surrounded by `%{...}` are
        substitutions from the input data: typically\nthe name of the object being
        modified, or some other critical detail, these\nallow roles to be granted
        partial access to modify the system.\n\nFor more detail on how the permission
        strings are structured and work, you can\nsee the [Shiro Permissions documentation][shiro].  That
        pattern is expanded\nand then a permission check applied to it, before the
        command is authorized.\n\nThese checks only apply if security is enabled in
        the Razor configuration\nfile; on this server security is currently disabled.\n\n[shiro]:
        https://shiro.apache.org/permissions.html\n\n# Attributes\n\n * name\n   -
        The name of the repository.\n   - This attribute is required.\n   - It must
        be of type string.\n   - It must be between 1 and 250 in length.\n\n * url\n   -
        The URL of the remote repository to use.\n   - It must be of type string.\n   -
        If present, iso-url must not be present.\n   - It must be between 1 and 1000
        in length.\n\n * iso-url\n   - The URL of the ISO image to download and unpack
        to create the\n     repository.  This can be an https or httpsS URL, or it can
        be a\n     file URL.\n     \n     In the latter case, the file path is interpreted
        as a path on the\n     Razor server, rather than a path on the client.  This
        requires that\n     you manually place the ISO image on the server before
        invoking the\n     command.\n   - It must be of type string.\n   - If present,
        url must not be present.\n   - It must be between 1 and 1000 in length.\n\n
        * task\n   - The name of the task associated with this repository.  This is
        used to\n     install nodes that match a policy using this repository; generally
        it\n     should match the OS that the URL or ISO-URL attributes point to.\n   -
        This attribute is required.\n   - It must be of type string.\n\n# EXAMPLES\n\n  Create
        a repository from an ISO image, which will be downloaded and unpacked\n  by
        the razor-server in the background:\n  \n      {\n        \"name\":    \"fedora19\",\n        \"iso-url\":
        \"https://example.com/Fedora-19-x86_64-DVD.iso\"\n        \"task\":    \"fedora\"\n      }\n  \n  You
        can also unpack an ISO image from a file *on the server*; this does not\n  upload
        the file from the client:\n      {\n        \"name\":    \"fedora19\",\n        \"iso-url\":
        \"file:///tmp/Fedora-19-x86_64-DVD.iso\"\n        \"task\":    \"fedora\"\n      }\n  \n  Finally,
        you can provide a `url` property when you create the repository;\n  this form
        is merely a pointer to a resource somewhere and nothing will be\n  downloaded
        onto the Razor server:\n  \n      {\n        \"name\": \"fedora19\",\n        \"url\":  \"https://mirrors.n-ix.net/fedora/linux/releases/19/Fedora/x86_64/os/\"\n        \"task\":
        \"fedora\"\n      }\n"},"schema":{"name":{"type":"string"},"url":{"type":"string"},"iso-url":{"type":"string"},"task":{"type":"string"}}}'
    http_version:
  recorded_at: Thu, 14 Aug 2014 21:10:26 GMT
- request:
    method: post
    uri: https://localhost:8151/api/commands/create-repo
    body:
      encoding: UTF-8
      string: '{"name":"''with=equals''","url":"https://url.com/some.iso","task":"noop"}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Content-Type:
      - application/json
      Content-Length:
      - '70'
      User-Agent:
      - Ruby
  response:
    status:
      code: 202
      message: Accepted
    headers:
      Server:
      - Apache-Coyote/1.1
      X-Content-Type-Options:
      - nosniff
      Content-Type:
      - application/json;charset=utf-8
      Content-Length:
      - '219'
      Date:
      - Thu, 14 Aug 2014 21:10:25 GMT
    body:
      encoding: US-ASCII
      string: '{"spec":"https://api.puppetlabs.com/razor/v1/collections/repos/member","id":"https://localhost:8151/api/collections/repos/''with=equals''","name":"''with=equals''","command":"https://localhost:8151/api/collections/commands/1"}'
    http_version:
  recorded_at: Thu, 14 Aug 2014 21:10:26 GMT
- request:
    method: get
    uri: https://localhost:8151/api/collections/repos/'with=equals'
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      Server:
      - Apache-Coyote/1.1
      X-Content-Type-Options:
      - nosniff
      Content-Type:
      - application/json;charset=utf-8
      Content-Length:
      - '353'
      Date:
      - Thu, 14 Aug 2014 21:10:25 GMT
    body:
      encoding: US-ASCII
      string: '{"spec":"https://api.puppetlabs.com/razor/v1/collections/repos/member","id":"https://localhost:8151/api/collections/repos/''with=equals''","name":"''with=equals''","iso_url":null,"url":"https://url.com/some.iso","task":{"spec":"https://api.puppetlabs.com/razor/v1/collections/tasks/member","id":"https://localhost:8151/api/collections/tasks/noop","name":"noop"}}'
    http_version:
  recorded_at: Thu, 14 Aug 2014 21:10:26 GMT
recorded_with: VCR 2.9.2
